require=function e(t,c,n){function i(a,s){if(!c[a]){if(!t[a]){var r="function"==typeof require&&require;if(!s&&r)return r(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var u=c[a]={exports:{}};t[a][0].call(u.exports,function(e){var c=t[a][1][e];return i(c||e)},u,u.exports,e,t,c,n)}return c[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({Bean:[function(e,t,c){"use strict";cc._RF.push(t,"43f66aRdYhCG6ajsgfm4gkB","Bean"),cc.Class({extends:cc.Component,properties:{id:0,isExplore:!1,image1:{default:null,type:cc.SpriteFrame},image2:{default:null,type:cc.SpriteFrame},image3:{default:null,type:cc.SpriteFrame},image4:{default:null,type:cc.SpriteFrame},image5:{default:null,type:cc.SpriteFrame},image6:{default:null,type:cc.SpriteFrame},imageHit1:{default:null,type:cc.SpriteFrame},imageHit2:{default:null,type:cc.SpriteFrame},imageHit3:{default:null,type:cc.SpriteFrame},imageHit4:{default:null,type:cc.SpriteFrame},imageHit5:{default:null,type:cc.SpriteFrame},imageHit6:{default:null,type:cc.SpriteFrame},particleFactory:{default:null,type:cc.Prefab}},start:function(){},init:function(e,t,c,n){this.id=c,this.gameScene=n;var i;switch(c){case 1:i=this.image1;break;case 2:i=this.image2;break;case 3:i=this.image3;break;case 4:i=this.image4;break;case 5:i=this.image5;break;case 6:i=this.image6}this.setSpriteFrame(i)},setSpriteFrame:function(e){this.node.getComponent(cc.Sprite).spriteFrame=e,this.node.width=e.getRect().width,this.node.height=e.getRect().height},knock:function(){this.spriteArray[x][y].hit(),this.beansArray[x][y]=0},hit:function(){this.node.setLocalZOrder(2),this.node.stopAllActions(),this.node.removeAllChildren();var e;switch(this.id){case 1:e=this.imageHit1;break;case 2:e=this.imageHit2;break;case 3:e=this.imageHit3;break;case 4:e=this.imageHit4;break;case 5:e=this.imageHit5;break;case 6:e=this.imageHit6}this.setSpriteFrame(e),this.node.runAction(new cc.Sequence(new cc.ScaleTo(.1,1.3),new cc.ScaleTo(.1,1),new cc.DelayTime(.4),new cc.ScaleTo(.6,.5))),this.node.runAction(new cc.Sequence(new cc.DelayTime(.1*Math.random()),new cc.DelayTime(.2),new cc.EaseBackIn(new cc.MoveTo(.7,cc.p(434,1490))),new cc.CallFunc(this.clashStar,this)))},clashStar:function(){var e=cc.instantiate(this.particleFactory);e.getComponent("ParticalFactory").createStarEffect(2),e.setPosition(this.node.getPosition()),this.gameScene.getComponent("GameScene").boardNode.addChild(e),this.gameScene.updateScore(),this.node.removeFromParent()},explore:function(){this.vx=12*Math.random()-6,this.vy=8*Math.random()+8,this.isExplore=!0},update:function(e){this.isExplore&&(this.node.setPosition(this.node.getPosition().x+this.vx,this.node.getPosition().y+this.vy),this.vy-=1,this.node.getPosition().y<-300&&this.node.removeFromParent())}}),cc._RF.pop()},{}],BtnContinue:[function(e,t,c){"use strict";cc._RF.push(t,"b0cafRW/RVEeLhgWNDkHAWZ","BtnContinue"),cc.Class({extends:cc.Component,properties:{},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1),this.next()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},bind:function(e){this.overLayer=e},next:function(){this.overLayer.next()}}),cc._RF.pop()},{}],BtnMusic:[function(e,t,c){"use strict";cc._RF.push(t,"334e5IGnldOL7NofFPYsvg0","BtnMusic"),cc.Class({extends:cc.Component,properties:{imageOn:cc.SpriteFrame,imageOff:cc.SpriteFrame},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1)},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},gamePause:function(){}}),cc._RF.pop()},{}],BtnPause:[function(e,t,c){"use strict";cc._RF.push(t,"e92ee/+17dHiJ+mW7Doqn2G","BtnPause"),cc.Class({extends:cc.Component,properties:{gameCanvas:{default:null,type:cc.Node}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setOpacity(172),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setOpacity(172)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setOpacity(255),this.gamePause()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setOpacity(255)},this)},gamePause:function(){this.gameCanvas.getComponent("GameScene").gamePause()}}),cc._RF.pop()},{}],BtnRestartNo:[function(e,t,c){"use strict";cc._RF.push(t,"a7d9e/T5EFDGLRwmiJhhH87","BtnRestartNo"),cc.Class({extends:cc.Component,properties:{pausePanel:{default:null,type:cc.Node}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1),this.gameRestart()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},gameRestart:function(){this.pausePanel.getComponent("PauseLayer").hideConfirm()}}),cc._RF.pop()},{}],BtnRestartYes:[function(e,t,c){"use strict";cc._RF.push(t,"ee80akw27RNObrMqL1F1mLG","BtnRestartYes"),cc.Class({extends:cc.Component,properties:{pausePanel:{default:null,type:cc.Node}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1),this.gameRestart()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},gameRestart:function(){this.pausePanel.removeFromParent(),this.pausePanel.getComponent("PauseLayer").gameRestart()}}),cc._RF.pop()},{}],BtnRestart:[function(e,t,c){"use strict";cc._RF.push(t,"c2bd6mCp4BL5LtQbJxnBKUC","BtnRestart"),cc.Class({extends:cc.Component,properties:{pausePanel:cc.Node},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1),this.gameRestart()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},gameRestart:function(){this.pausePanel.getComponent("PauseLayer").showConfirm()}}),cc._RF.pop()},{}],BtnResume:[function(e,t,c){"use strict";cc._RF.push(t,"a4bb49dOnlAaZeqJ+OQXGAl","BtnResume"),cc.Class({extends:cc.Component,properties:{pauseLayer:{default:null,type:cc.Node}},start:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return this.node.setScale(.9),!0},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setScale(.9)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setScale(1),this.gameResume()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setScale(1)},this)},gameResume:function(){this.pauseLayer.getComponent("PauseLayer").gameResume(),this.pauseLayer.removeFromParent()}}),cc._RF.pop()},{}],BtnStart:[function(e,t,c){"use strict";cc._RF.push(t,"89ffd6VZ4hHVJXZlu5dALGM","BtnStart"),cc.Class({extends:cc.Component,properties:{audioClick:cc.AudioClip,bgm:cc.AudioClip},start:function(){cc.audioEngine.play(this.bgm,!0),this.node.setScale(0);var e=new cc.RepeatForever(new cc.Sequence(new cc.EaseSineInOut(new cc.ScaleTo(1,1)),new cc.EaseSineInOut(new cc.ScaleTo(1,.9))));this.node.runAction(e),this.node.on(cc.Node.EventType.TOUCH_START,function(e){this.node.setOpacity(172)},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){this.node.setOpacity(172)},this),this.node.on(cc.Node.EventType.TOUCH_END,function(e){this.node.setOpacity(255),cc.audioEngine.play(this.audioClick),this.gameStart()},this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(e){this.node.setOpacity(255)},this)},gameStart:function(){cc.director.loadScene("gameScene")}}),cc._RF.pop()},{}],CoinPartical:[function(e,t,c){"use strict";cc._RF.push(t,"fa4fahn1rhHWJ/25IgjrPP9","CoinPartical"),cc.Class({extends:cc.Component,properties:{vx:0,vy:0},start:function(){},setDt:function(e){this.node.setPosition(20*Math.random()-10,20*Math.random()-10),this.node.runAction(new cc.Sequence(new cc.DelayTime(.1*e),new cc.EaseBackIn(new cc.MoveTo(.7,cc.p(434,1490))),new cc.FadeTo(0,0)))}}),cc._RF.pop()},{}],GameScene:[function(e,t,c){"use strict";function n(e,t,c){return t in e?Object.defineProperty(e,t,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[t]=c,e}function i(e,t){return t>=e.length&&(t=e.length-1),e[t]}function o(e,t){return e<=r.width-1&&e>=0&&t<=r.height-1&&t>=0}cc._RF.push(t,"53cf95SlpRGu5H5GQU1TFsy","GameScene");var a,s,r=cc.size(7,9),h=cc.size(144,144),u=[1,1,2],l=[0,0,0,0,10,10,10,20,20,20,50],d=[0,1e3,2250,3500,5e3,8e3,10500,13e3,16e3,2e4,25e3,32e3,38e3,46e3,5e4,53e3,58e3,68e3,75e3,84e3,1e5],p=[0,0,10,10,10,10,8,6,20,0,5,6,5,0,11,0,7,0,0,2,0],m=[0,0,0,1,1,1,3,2,2,0,2,2,6,30,2,3,2,2,6,2,5],y=[0,0,1,1,1,1,1,1,0,0,2,2,2,0,2,0,2,24,4,2,25],f=[0,4,4,5,5,5,5,5,5,4,5,5,5,5,5,6,6,5,6,6,4],w=[1],S=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,1,0,3,0,1,0,0,0,0,0,0,0,0,0,1,0,3,0,1,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,1,1,1,0,0,0,0,1,2,1,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,0,0,0,2,1,1,1,1,1,1,1,1,1,2,0,0,0,2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,2,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1,3,1,3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,0,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,3],[0,0,0,1,0,0,0,0,0,1,3,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,3,1,0,1,3,1,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,3,1,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,1,1,2,1,1,3,1,1,1,3,1,1,2,1,3,1,2,1,1,2,1,1,1,2,1,1,2,2,2,2,2,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,1,3,1,0,0,0,1,3,3,1,0,0,0,1,3,3,1,0,0,0,1,3,3,1,3,3,3,1,3],[1,3,1,3,1,3,1,3,0,0,0,0,0,3,1,0,0,0,0,0,1,3,0,0,0,0,0,3,1,0,0,0,0,0,1,3,0,0,0,0,0,3,1,0,0,0,0,0,1,3,0,0,0,0,0,3,1,3,1,3,1,3,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,1,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,1,2,0,0,0,2,1,1,1,1,0,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,3,3,3,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,3,0,0,0,0,0,3,0,3,0,0,0,3,0,0,0,3,0,3,0,0,0,0,0,3,0,0,0,0,0,0,0,3,0,0,0,0,0,3,0,3,0,0,0,3,0,0,0,3,0,3,0,0,0,0,0,3,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,1,0,1,0,0,0,0,1,1,0]];cc.Class({extends:cc.Component,properties:(a={topView:cc.Node,bottomView:cc.Node,boardNode:null,beansArray:[],spriteArray:[],countTempArray:[],count:null,untouch:!1,effect:null,score:0,realScore:0,scoreDisplay:0,powerDisplay:0,combo:0,comboTime:0,level:1,levelDisplay:1,power:0,beanPrefab:{default:null,type:cc.Prefab},hintFrame:{default:null,type:cc.Prefab},iceBlockPrefab:{default:null,type:cc.Prefab},labelLevelupPrefab:{default:null,type:cc.Prefab},pausePanel:{default:null,type:cc.Prefab},overPanel:{default:null,type:cc.Prefab}},n(a,"boardNode",{default:null,type:cc.Node}),n(a,"uiNode",{default:null,type:cc.Node}),n(a,"scoreLabel",{default:null,type:cc.Label}),n(a,"comboLabel",{default:null,type:cc.Label}),n(a,"levelLabel",{default:null,type:cc.Label}),n(a,"comboTag",{default:null,type:cc.Node}),n(a,"progressBar",{default:null,type:cc.Node}),n(a,"audioHit2",cc.AudioClip),n(a,"audioHit3",cc.AudioClip),n(a,"audioHit4",cc.AudioClip),n(a,"audioHit5",cc.AudioClip),n(a,"audioLvUp",cc.AudioClip),a),start:function(){s=this;for(var e=0;e<r.width;e++)this.beansArray[e]=new Array,this.spriteArray[e]=new Array,this.countTempArray[e]=new Array;this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchBegan,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnded,this),this.newGame(),this.showBars()},onTouchBegan:function(e){if(this.untouch)return!1},onTouchMove:function(e){},onTouchEnded:function(e){if(this.untouch)return!1;var t=this.boardNode.convertToNodeSpace(e.getLocation());t.x+=h.width/2,t.y+=h.height/2;var c=Math.floor(t.x/h.width),n=Math.floor(t.y/h.height);this.clickxy(c,n)},newGame:function(){this.level=1,this.levelLabel.string=1,this.combo=0,this.score=0,this.realScore=0,this.scoreDisplay=0,this.scoreLabel.string=0,this.clearCombo(),this.putBlocks(),this.updatePowerBar(),this.showHint()},clearBoard:function(){this.untouch=!0;for(var e=0;e<r.width;e++)for(var t=0;t<r.height;t++)this.spriteArray[e][t].runAction(new cc.Sequence(new cc.DelayTime(.1*(r.height-t-1)),new cc.Spawn(new cc.FadeTo(.3,0),new cc.EaseQuadraticActionOut(new cc.ScaleTo(.5,0))),new cc.CallFunc(this.spriteArray[e][t].removeFromParent,this.spriteArray[e][t])));this.boardNode.runAction(new cc.Sequence(new cc.DelayTime(1.3),new cc.CallFunc(this.boardNode.removeAllChildren,this.boardNode)))},putBlocks:function(){this.clearCombo(),this.levelDisplay=this.level,this.node.runAction(new cc.Sequence(new cc.DelayTime(1.2),new cc.CallFunc(function(){s.untouch=!1}))),this.boardNode.removeAllChildren();for(var e=0;e<r.width;e++)for(var t=0;t<r.height;t++){var c=i(S,this.level);if(0!=c[e+(r.height-t-1)*r.width])this.putBall(e,t,-c[e+(r.height-t-1)*r.width]);else{var n=Math.floor(Math.random()*i(f,this.level))+1;this.putBall(e,t,n)}}},putBallRandom:function(e,t){if(i(p,this.level)>100*Math.random())this.putBall(e,t,-1);else if(i(m,this.level)>100*Math.random())this.putBall(e,t,-2);else if(i(y,this.level)>100*Math.random())this.putBall(e,t,-3);else{var c=Math.floor(Math.random()*i(f,this.level))+1;this.putBall(e,t,c)}},putBall:function(e,t,c){this.beansArray[e][t]=c,c<0?(this.spriteArray[e][t]=cc.instantiate(this.iceBlockPrefab),this.spriteArray[e][t].getComponent("IceBlock").init(e,t,c,this)):(this.spriteArray[e][t]=cc.instantiate(this.beanPrefab),this.spriteArray[e][t].getComponent("Bean").init(e,t,c,this)),this.spriteArray[e][t].setPosition(e*h.width,t*h.height+r.height*h.height),this.spriteArray[e][t].setOpacity(0),this.spriteArray[e][t].runAction(new cc.Sequence(new cc.DelayTime(1-1*(r.height-t)/r.height),new cc.FadeTo(.1,255)));var n=1.25-t/r.height;this.spriteArray[e][t].runAction(new cc.Sequence(new cc.EaseQuadraticActionIn(new cc.MoveBy(1+.3*(1-n),cc.p(0,-r.height*h.height))),this.effect,new cc.EaseSineOut(new cc.ScaleTo(.16,1+.2*n,1-.07*n)),new cc.EaseSineOut(new cc.ScaleTo(.08,1-.05*n,1+.08*n)),new cc.EaseSineOut(new cc.ScaleTo(.05,1,1)))),this.boardNode.addChild(this.spriteArray[e][t])},clickxy:function(e,t){if(!(e<0||e>=r.width||t<0||t>=r.height||this.beansArray[e][t]<=0)){this.count=0;for(c=0;c<r.width;c++)for(n=0;n<r.height;n++)this.countTempArray[c][n]=0;if(this.countNear(e,t),this.count>=2){for(c=0;c<r.width;c++)for(n=0;n<r.height;n++)1==this.countTempArray[c][n]&&(this.hitBean(c,n),c-1>=0&&this.beansArray[c-1][n]<0&&(this.countTempArray[c-1][n]=-1),n-1>=0&&this.beansArray[c][n-1]<0&&(this.countTempArray[c][n-1]=-1),c+1<r.width&&this.beansArray[c+1][n]<0&&(this.countTempArray[c+1][n]=-1),n+1<r.height&&this.beansArray[c][n+1]<0&&(this.countTempArray[c][n+1]=-1));for(var c=0;c<r.width;c++)for(var n=0;n<r.height;n++)-1==this.countTempArray[c][n]&&this.beansArray[c][n]<0&&this.spriteArray[c][n].getComponent("IceBlock").knock();switch(this.fillBoard(),this.comboTime<2?this.getCombo():this.clearCombo(),this.combo){case 3:cc.audioEngine.play(this.audioHit3);break;case 6:cc.audioEngine.play(this.audioHit4);break;case 9:cc.audioEngine.play(this.audioHit5);break;default:cc.audioEngine.play(this.audioHit2)}var o=(10*this.count*i(u,this.combo)+i(l,this.count))*i(w,this.level);this.getScore(o)}}},countNear:function(e,t){this.count++,this.countTempArray[e][t]=1,o(e+1,t)&&0==this.countTempArray[e+1][t]&&this.beansArray[e+1][t]==this.beansArray[e][t]&&this.countNear(e+1,t),o(e-1,t)&&0==this.countTempArray[e-1][t]&&this.beansArray[e-1][t]==this.beansArray[e][t]&&this.countNear(e-1,t),o(e,t+1)&&0==this.countTempArray[e][t+1]&&this.beansArray[e][t+1]==this.beansArray[e][t]&&this.countNear(e,t+1),o(e,t-1)&&0==this.countTempArray[e][t-1]&&this.beansArray[e][t-1]==this.beansArray[e][t]&&this.countNear(e,t-1)},fillBoard:function(){for(i=0;i<r.width;i++)for(c=0;c<r.height;c++)this.countTempArray[i][c]=0;for(i=0;i<r.width;i++)for(c=0;c<r.height;c++)if(0==this.beansArray[i][c])for(var e=c+1;e<r.height;e++)this.countTempArray[i][e]++;for(i=0;i<r.width;i++)for(var t=new cc.CallFunc(this.playDropEffect,this),c=0;c<r.height;c++)if(0!=this.beansArray[i][c]&&0!=this.countTempArray[i][c]){this.beansArray[i][c]<0?this.spriteArray[i][c].getComponent("IceBlock").cy=c-this.countTempArray[i][c]:this.spriteArray[i][c].getComponent("Bean").cy=c-this.countTempArray[i][c],this.beansArray[i][c-this.countTempArray[i][c]]=this.beansArray[i][c],this.beansArray[i][c]=0;var n=1.25-c/r.height;this.spriteArray[i][c].runAction(new cc.Sequence(new cc.DelayTime((1+.3*(1-n))*(1-this.countTempArray[i][c]/r.height)),new cc.EaseQuadraticActionIn(new cc.MoveBy(1*this.countTempArray[i][c]/r.height,cc.p(0,-this.countTempArray[i][c]*h.width))),t,new cc.EaseSineOut(new cc.ScaleTo(.16,1+.2*n,1-.07*n)),new cc.EaseSineOut(new cc.ScaleTo(.08,1-.05*n,1+.07*n)),new cc.EaseSineOut(new cc.ScaleTo(.05,1,1)))),this.spriteArray[i][c-this.countTempArray[i][c]]=this.spriteArray[i][c],t=new cc.DelayTime(0)}for(var i=0;i<r.width;i++){this.effect=new cc.CallFunc(this.playDropEffect,this);for(c=0;c<r.height;c++)0==this.beansArray[i][c]&&this.putBallRandom(i,c);this.effect=new cc.DelayTime(0)}this.checkFail()&&this.gameOver()},checkFail:function(){if(this.untouch)return!1;for(e=0;e<r.width;e++)for(t=0;t<r.height;t++)this.countTempArray[e][t]=0;for(var e=0;e<r.width;e++)for(var t=0;t<r.height;t++){if(-2==this.beansArray[e][t]&&this.spriteArray[e][t].time<=0)return!1;if(!(this.beansArray[e][t]<0)&&(this.count=0,this.countNear(e,t),this.count>1))return!1}return!0},hitBean:function(e,t){this.beansArray[e][t]<0?this.spriteArray[e][t].getComponent("IceBlock").hit():this.beansArray[e][t]>0&&(this.spriteArray[e][t].getComponent("Bean").hit(),this.beansArray[e][t]=0)},getCombo:function(){this.comboTime=0,++this.combo>=2&&(this.comboLabel.string=":"+this.combo,this.comboLabel.node.stopAllActions(),this.comboLabel.node.setScale(1.5),this.comboLabel.node.runAction(new cc.Sequence(new cc.EaseSineIn(new cc.ScaleTo(.05,1.7)),new cc.EaseSineIn(new cc.ScaleTo(.1,1.5)))),this.comboTag.stopAllActions(),this.comboTag.setOpacity(255),this.comboTag.setPosition(540,1650),this.comboTag.setScale(1),this.comboTag.runAction(new cc.Sequence(new cc.ScaleTo(.1,1.25),new cc.DelayTime(.6),new cc.FadeTo(.8,0))))},clearCombo:function(){this.combo=0,this.comboTime=0,this.comboLabel.string=":"+this.combo},updatePowerBar:function(){var e=(this.score-d[this.levelDisplay-1])/(d[this.levelDisplay]-d[this.levelDisplay-1]);this.powerDisplay+=(e-this.powerDisplay)/50,this.powerDisplay>1&&(this.powerDisplay=1),this.powerDisplay<0&&(this.powerDisplay=0),this.progressBar.width=791*this.powerDisplay*2},getScore:function(e){var t=Math.floor(e);this.realScore+=t,this.node.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(function(){s.score+=t}))),this.realScore>=d[this.level]&&this.levelUp()},levelUp:function(){s.level++,cc.audioEngine.play(this.audioLvUp),this.node.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.CallFunc(function(){s.levelLabel.string=s.level})));var e=cc.instantiate(this.labelLevelupPrefab);e.setPosition(540,880),e.setOpacity(0),e.runAction(new cc.Sequence(new cc.FadeTo(.4,255),new cc.MoveBy(.4,cc.p(0,200)),new cc.DelayTime(.5),new cc.FadeTo(.4,255),new cc.MoveBy(.4,cc.p(0,200)),new cc.CallFunc(e.removeFromParent,e))),this.uiNode.addChild(e),this.untouch=!0,this.level>20?(this.level=20,this.node.runAction(new cc.Sequence(new cc.DelayTime(4),new cc.CallFunc(this.showOverLayer,this)))):this.node.runAction(new cc.Sequence(new cc.DelayTime(3.5),new cc.CallFunc(this.putBlocks,this))),this.node.runAction(new cc.Sequence(new cc.DelayTime(1.75),new cc.CallFunc(this.clearBoard,this)));for(var t=0;t<r.width;t++)for(var c=0;c<r.height;c++)-2==this.beansArray[t][c]&&(this.spriteArray[t][c].cancleItem=!0)},updateScore:function(){this.scoreLabel.node.stopAllActions(),this.scoreLabel.node.runAction(new cc.Sequence(new cc.EaseSineIn(new cc.ScaleTo(.05,1.7)),new cc.EaseSineIn(new cc.ScaleTo(.1,1.5))))},restart:function(){this.clearBoard(),this.node.runAction(new cc.Sequence(new cc.DelayTime(1.5),new cc.CallFunc(this.newGame,this)))},gameOver:function(){this.untouch=!0;for(var e=0;e<r.width;e++)for(var t=0;t<r.height;t++){var c;this.beansArray[e][t]<0?c=this.spriteArray[e][t].getComponent("IceBlock"):this.beansArray[e][t]>0&&(c=this.spriteArray[e][t].getComponent("Bean")),this.spriteArray[e][t].runAction(new cc.Sequence(new cc.DelayTime(2+.5*Math.random()),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.EaseSineIn(new cc.MoveBy(.05+.05*Math.random(),cc.p(20*Math.random()-10,20*Math.random()-10))),new cc.CallFunc(c.explore,c)))}this.node.runAction(new cc.Sequence(new cc.DelayTime(4),new cc.CallFunc(this.showOverLayer,this)))},showOverLayer:function(){var e=cc.instantiate(this.overPanel);e.getComponent("OverLayer").init(this,this.level,this.score),this.uiNode.addChild(e),this.hideBars()},showHint:function(){for(var e=0;e<r.width;e++){for(var t=0;t<r.height;t++){var c=(e+3)%r.width,n=(t+3)%r.height;if(-2==this.beansArray[c][n]&&this.spriteArray[c][n].time<=0)return!1;if(!(this.beansArray[c][n]<0)){this.count=0;for(var i=0;i<r.width;i++)for(var o=0;o<r.height;o++)this.countTempArray[i][o]=0;if(this.countNear(c,n),this.count>1)break}}if(this.count>1)break}for(c=0;c<r.width;c++)for(n=0;n<r.height;n++)if(0!=this.countTempArray[c][n]){var a=cc.instantiate(this.hintFrame);a.setOpacity(0),a.runAction(new cc.Sequence(new cc.DelayTime(1.5),new cc.FadeTo(.5,255),new cc.FadeTo(.5,72),new cc.FadeTo(.5,255),new cc.FadeTo(.5,72),new cc.FadeTo(.5,255),new cc.FadeTo(.5,72),new cc.FadeTo(.5,255),new cc.FadeTo(1,0))),this.spriteArray[c][n].addChild(a),cc.log(a)}},gamePause:function(){this.untouch=!0;var e=cc.instantiate(this.pausePanel);e.getComponent("PauseLayer").bind(this),this.uiNode.addChild(e)},gameResume:function(){this.untouch=!1},showBars:function(){this.bottomView.runAction(new cc.EaseSineOut(new cc.MoveBy(.4,cc.p(0,200)))),this.topView.runAction(new cc.EaseSineOut(new cc.MoveBy(.4,cc.p(0,-200))))},hideBars:function(){this.bottomView.runAction(new cc.EaseSineOut(new cc.MoveBy(1,cc.p(0,-200)))),this.topView.runAction(new cc.EaseSineOut(new cc.MoveBy(1,cc.p(0,200))))},update:function(e){this.comboTime+=e,this.scoreDisplay<this.score&&(this.scoreDisplay+=Math.ceil((this.score-this.scoreDisplay)/30),this.scoreLabel.string=this.scoreDisplay),this.updatePowerBar()}}),cc._RF.pop()},{}],IceBlock:[function(e,t,c){"use strict";function n(e,t){return e<=i.width-1&&e>=0&&t<=i.height-1&&t>=0}cc._RF.push(t,"01d04yt6B5Ac4b6ihASWWPT","IceBlock");var i=cc.size(7,9);cc.Class({extends:cc.Component,properties:{time:0,item:0,cancleItem:!1,isExplore:!1,sp:{default:null,type:cc.Node},bombImage:{default:null,type:cc.SpriteFrame},coinImage:{default:null,type:cc.SpriteFrame},iceImage1:{default:null,type:cc.SpriteFrame},iceImage2:{default:null,type:cc.SpriteFrame},iceImage3:{default:null,type:cc.SpriteFrame},particleFactory:{default:null,type:cc.Prefab},audioIceClash:cc.AudioClip,audioBomb:cc.AudioClip,audioCoin:cc.AudioClip},start:function(){},init:function(e,t,c,n){this.cx=e,this.cy=t,this.item=c,this.time=3,this.gameScene=n;var i;switch(c){case-2:i=this.bombImage;break;case-3:i=this.coinImage}-1!=c&&this.setSpriteFrame(i)},setSpriteFrame:function(e){this.node.getComponent(cc.Sprite).spriteFrame=e,this.node.width=e._originalSize.width,this.node.height=e._originalSize.height},knock:function(){if(2==--this.time&&(this.sp.getComponent(cc.Sprite).spriteFrame=this.iceImage2),1==this.time&&(this.sp.getComponent(cc.Sprite).spriteFrame=this.iceImage3),0==this.time)this.hit();else{var e=cc.instantiate(this.particleFactory);e.getComponent("ParticalFactory").createIceEffect(7-2*this.time),e.setPosition(this.node.getPosition()),this.gameScene.getComponent("GameScene").boardNode.addChild(e);var t=16*Math.random()-8,c=16*Math.random()-8;this.node.runAction(new cc.Sequence(new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(t,c))),new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(-2*t,-2*c))),new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(t,c)))))}cc.audioEngine.play(this.audioIceClash)},hit:function(){-2==this.item?(this.time=0,this.node.runAction(new cc.Sequence(new cc.DelayTime(1.3),new cc.CallFunc(this.itemBomb,this))),this.sp.removeFromParent(),this.node.runAction(new cc.Sequence(new cc.ScaleTo(.4,1.05),new cc.ScaleTo(.4,.9),new cc.ScaleTo(.5,1.2)))):-3==this.item?(this.time=0,this.node.runAction(new cc.Sequence(new cc.DelayTime(.4),new cc.CallFunc(this.itemCoin,this))),this.sp.removeFromParent(),this.node.runAction(new cc.Spawn(new cc.ScaleTo(.4,1.1),new cc.FadeTo(.4,0)))):(this.gameScene.getScore(4),this.gameScene.beansArray[this.cx][this.cy]=0,this.node.removeFromParent());var e=cc.instantiate(this.particleFactory);e.getComponent("ParticalFactory").createIceEffect(7),e.setPosition(this.node.getPosition()),this.gameScene.getComponent("GameScene").boardNode.addChild(e);var t=16*Math.random()-8,c=16*Math.random()-8;this.node.runAction(new cc.Sequence(new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(t,c))),new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(-2*t,-2*c))),new cc.EaseSineIn(new cc.MoveBy(.05,cc.p(t,c)))))},itemBomb:function(){if(!this.cancleItem){this.gameScene.getScore(80);for(var e=this.cx-1;e<=this.cx+1;e++)for(var t=this.cy-1;t<=this.cy+1;t++)if(n(e,t)&&null!=this.gameScene.beansArray[e][t]&&0!=this.gameScene.beansArray[e][t]){if(e==this.cx&&t==this.cy)continue;this.gameScene.hitBean(e,t)}this.gameScene.beansArray[this.cx][this.cy]=0,this.gameScene.fillBoard()}cc.audioEngine.play(this.audioBomb);var c=cc.instantiate(this.particleFactory);c.getComponent("ParticalFactory").createStarEffect(5),c.setPosition(this.node.getPosition()),this.gameScene.getComponent("GameScene").boardNode.addChild(c),this.node.removeFromParent()},itemCoin:function(){if(!this.cancleItem){this.gameScene.getScore(250),cc.audioEngine.playEffect(this.audioCoin),this.gameScene.beansArray[this.cx][this.cy]=0,this.gameScene.fillBoard();var e=cc.instantiate(this.particleFactory);e.getComponent("ParticalFactory").createCoinEffect(5,this.node.getPosition()),this.gameScene.getComponent("GameScene").boardNode.addChild(e),this.node.removeFromParent()}},explore:function(){this.vx=12*Math.random()-6,this.vy=8*Math.random()+8,this.isExplore=!0},update:function(e){this.isExplore&&(this.node.setPosition(this.node.getPosition().x+this.vx,this.node.getPosition().y+this.vy),this.vy-=1,this.node.getPosition().y<-300&&this.node.removeFromParent())}}),cc._RF.pop()},{}],IcePartical:[function(e,t,c){"use strict";cc._RF.push(t,"532fa8aUXlMsoS2Z35Kwc7q","IcePartical"),cc.Class({extends:cc.Component,properties:{vx:0,vy:0},start:function(){this.node.setPosition(80*Math.random()-40,80*Math.random()-40),this.node.setRotation(360*Math.random()),this.node.setScale(1*Math.random()+.5,1*Math.random()+.5),this.vx=12*Math.random()-6,this.vy=9*Math.random()},update:function(e){this.vy-=1,this.node.setPosition(this.node.getPosition().x+this.vx,this.node.getPosition().y+this.vy)}}),cc._RF.pop()},{}],LoadingScene:[function(e,t,c){"use strict";cc._RF.push(t,"90bd4DoPAdAqqWap9vSJUL1","LoadingScene"),cc.Class({extends:cc.Component,properties:{logo:cc.Node},start:function(){cc.director.preloadScene("mainScene",function(){cc.director.preloadScene("gameScene",function(){cc.director.loadScene("mainScene")})}),this.logo.runAction(new cc.FadeTo(1,255))}}),cc._RF.pop()},{}],OverLayer:[function(e,t,c){"use strict";cc._RF.push(t,"36e28TXReZG4bK4rT0OhFnl","OverLayer"),cc.Class({extends:cc.Component,properties:{title:cc.Node,titleLevel:cc.Node,titleScore:cc.Node,labelLevel:cc.Node,labelScore:cc.Node,btnContinue:cc.Node,gameScene:null,level:0,score:0,scoreDisplay:0},start:function(){this.title.runAction(new cc.Sequence(new cc.DelayTime(0),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.titleLevel.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.titleScore.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.labelLevel.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.labelScore.runAction(new cc.Sequence(new cc.DelayTime(2),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.btnContinue.runAction(new cc.Sequence(new cc.DelayTime(3),new cc.Spawn(new cc.MoveBy(.5,cc.p(0,100)),new cc.FadeTo(.5,255)))),this.btnContinue.getComponent("BtnContinue").bind(this),this.schedule(this.updateScore,.05,65536,2)},init:function(e,t,c){this.gameScene=e,this.level=t,this.score=c,this.labelLevel.getComponent(cc.Label).string=t},next:function(){this.gameScene.newGame(),this.gameScene.showBars(),this.node.removeFromParent()},updateScore:function(e){this.scoreDisplay+=this.score/25,this.scoreDisplay>this.score&&(this.unschedule(this.updateScore),this.scoreDisplay=this.score),this.labelScore.getComponent(cc.Label).string=Math.floor(this.scoreDisplay)}}),cc._RF.pop()},{}],ParticalFactory:[function(e,t,c){"use strict";cc._RF.push(t,"3e421q83CVPK5jrTysl0uwM","ParticalFactory"),cc.Class({extends:cc.Component,properties:{iceParticle:{default:null,type:cc.Prefab},starParticle:{default:null,type:cc.Prefab},coinParticle:{default:null,type:cc.Prefab}},start:function(){},createIceEffect:function(e){for(var t=0;t<e;t++)this.node.addChild(cc.instantiate(this.iceParticle));this.node.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(this.node.removeFromParent,this.node)))},createStarEffect:function(e){for(var t=0;t<e;t++)this.node.addChild(cc.instantiate(this.starParticle));this.node.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(this.node.removeFromParent,this.node)))},createCoinEffect:function(e,t){for(var c=0;c<e;c++){var n=cc.instantiate(this.coinParticle);n.getComponent("CoinPartical").setDt(c),n.setPosition(t),this.node.addChild(n)}this.node.runAction(new cc.Sequence(new cc.DelayTime(1),new cc.CallFunc(this.node.removeFromParent,this.node)))}}),cc._RF.pop()},{}],PauseLayer:[function(e,t,c){"use strict";cc._RF.push(t,"af960FQqfBCK7Ib/VSh1pXl","PauseLayer"),cc.Class({extends:cc.Component,properties:{gameScene:null,titlePause:cc.Node,btnMusic:cc.Node,btnResume:cc.Node,btnRestart:cc.Node,titleRestart:cc.Node,btnRestartYes:cc.Node,btnRestartNo:cc.Node},start:function(){},bind:function(e){this.gameScene=e},gameResume:function(){this.gameScene.gameResume()},showConfirm:function(){this.titlePause.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.btnMusic.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.btnResume.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.btnRestart.runAction(new cc.Sequence(new cc.EaseBackIn(new cc.ScaleTo(.5,0)),new cc.CallFunc(this.showConfirmBtn,this)))},showConfirmBtn:function(){this.titleRestart.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1))),this.btnRestartYes.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1))),this.btnRestartNo.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1)))},hideConfirm:function(){this.isRestarting=!1,this.titleRestart.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.titleRestart.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.btnRestartYes.runAction(new cc.EaseBackIn(new cc.ScaleTo(.5,0))),this.btnRestartNo.runAction(new cc.Sequence(new cc.EaseBackIn(new cc.ScaleTo(.5,0)),new cc.CallFunc(this.hideConfirmBtn,this)))},hideConfirmBtn:function(){this.titlePause.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1))),this.btnMusic.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1))),this.btnResume.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1))),this.btnRestart.runAction(new cc.EaseBackOut(new cc.ScaleTo(.5,1)))},gameRestart:function(){this.gameScene.restart()}}),cc._RF.pop()},{}],StarPartical:[function(e,t,c){"use strict";cc._RF.push(t,"a0c5fRCHAlFJqrskeukflzW","StarPartical"),cc.Class({extends:cc.Component,properties:{},start:function(){this.node.setPosition(20*Math.random()-10,20*Math.random()-10),this.node.setRotation(360*Math.random()),this.node.setScale(2),this.node.runAction(new cc.EaseQuadraticActionOut(new cc.MoveBy(.5,cc.p(300*Math.random()-150,300*Math.random()-150)))),this.node.runAction(new cc.RotateBy(.5,1e3*Math.random()-5e3)),this.node.runAction(new cc.FadeTo(.5,0))}}),cc._RF.pop()},{}]},{},["Bean","BtnContinue","BtnMusic","BtnPause","BtnRestart","BtnRestartNo","BtnRestartYes","BtnResume","CoinPartical","GameScene","IceBlock","IcePartical","OverLayer","ParticalFactory","PauseLayer","StarPartical","LoadingScene","BtnStart"]);